<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/header-apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/header-icon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/header-icon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="naExO9JokuG3a-OHUdrF8UrtMPNf1FyJ5Yt99ihFezY">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"klysisle.space","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="如何设计分布式的&quot;小&quot;游戏">
<meta property="og:type" content="article">
<meta property="og:title" content="如何设计分布式的&quot;小&quot;游戏">
<meta property="og:url" content="https://klysisle.space/archives/9177ae4e.html">
<meta property="og:site_name" content="Klysisle&#39;s 小窝">
<meta property="og:description" content="如何设计分布式的&quot;小&quot;游戏">
<meta property="og:locale">
<meta property="og:image" content="https://klysisle.space/images/Game/MMO-service.png">
<meta property="og:image" content="https://klysisle.space/images/Game/distributed-service.png">
<meta property="og:image" content="https://klysisle.space/images/Game/lockstep-01.png">
<meta property="article:published_time" content="2020-11-17T11:16:12.000Z">
<meta property="article:modified_time" content="2024-12-11T08:54:40.708Z">
<meta property="article:author" content="Kinly">
<meta property="article:tag" content="游戏开发">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://klysisle.space/images/Game/MMO-service.png">

<link rel="canonical" href="https://klysisle.space/archives/9177ae4e.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>如何设计分布式的"小"游戏 | Klysisle's 小窝</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Klysisle's 小窝</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Klysisle's 小窝</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://klysisle.space/archives/9177ae4e.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/kinly-avatar.png">
      <meta itemprop="name" content="Kinly">
      <meta itemprop="description" content="Klysisle's 小窝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Klysisle's 小窝">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          如何设计分布式的"小"游戏
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-17 19:16:12" itemprop="dateCreated datePublished" datetime="2020-11-17T19:16:12+08:00">2020-11-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-12-11 16:54:40" itemprop="dateModified" datetime="2024-12-11T16:54:40+08:00">2024-12-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">游戏开发</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
            <div class="post-description">如何设计分布式的"小"游戏</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><ul>
<li>从前….做的游戏基本都是小区概念的，区和区之间数据在物理上是隔离的，网络一般也都是隔离开的<code>（除了少数游戏会有一个注册发现discover的单点服务器统一管理服务器之间的链接）</code></li>
<li>是否开区从服务端开发的角度，一般是单区<code>（一组服务器）</code>ACU<code>（最高同时在线）</code>服务端是否撑的住<code>（主要是内存、磁盘IO、带宽、cpu）</code></li>
<li>当然很多服务端设计里也会把单区做成进程可扩展的方式，比如<code>MMO游戏</code>根据<code>场景</code>分不同的GameService<code>（逻辑服务器进程）</code>、<code>开房间</code>玩法的游戏会有多组<code>BattleService（战斗服务器）</code>分摊压力，也避免在某个进程出问题的时候不至于整区不能游戏</li>
<li>绝大部分小区的游戏服务端<code>数据存储（DB）</code>是个单点进程，或者有些不用单独的DBService，直接由GameService操作数据库的读写，数据库可能是Mysql、MongoDB<code>（落盘的物理存储）</code>+ redis、memcache<code>（高速内存存储）</code></li>
<li>玩家玩游戏需要选择他自己游戏角色所在的区，然后进入这个区开始游戏</li>
</ul>
<h3 id="常见的游戏"><a href="#常见的游戏" class="headerlink" title="常见的游戏"></a>常见的游戏</h3><h4 id="常见的MMO游戏服务端架构"><a href="#常见的MMO游戏服务端架构" class="headerlink" title="常见的MMO游戏服务端架构"></a>常见的MMO游戏服务端架构</h4><p><img src="/images/Game/MMO-service.png"></p>
<ul>
<li>玩家通过服务端区列表选择所在的区<code>（拿到LoginService的IP:Port）</code></li>
<li>链接LoginService认证账号，获得这次登陆的<code>凭证(token、signature)</code> 和 <code>GateService的IP:Port</code>，同时LoginService把凭证存储到Redis或者通过消息同步给GateService</li>
<li>链接GateService<code>（长连接）</code>，进行游戏</li>
<li>客户端的交互操作经由GateService<code>转发</code>到GameService，GameService的<code>回执和通知</code>消息经由GateService发送给玩家客户端</li>
<li>GameService 通过 DBService 从数据库<code>（DataBase）</code>拿到玩家的游戏数据，数据变更后发送到DBService，DBService负责在<code>合适的时间写入</code>数据库<code>（这里一般认为GameService的存储请求到达DBService，DBService将新的数据覆盖到内存就算成功，DBService会在一定的时间后将数据写入数据库（磁盘写入操作）；因为一般情况磁盘读写是最耗时的操作）</code>。</li>
<li>图中<code>黄色较粗</code>的链接线表示<code>内网</code>的数据传输，一般内网的带宽是1G，服务端一般认为这里是不会有带宽资源不够的情况</li>
<li>图中没有单独的BattleService，因为对于<code>MMO游戏</code>来说，<code>场景同步</code>一般才是最影响服务端性能部分，游戏服务器的架构也更倾向处理场景同步的问题</li>
<li>而对于没有场景同步需求的游戏，或者一场战斗只是几个人的游戏，比如1V1的<code>2人游戏</code>，MOBA类型的<code>10人游戏</code>；更在意的是<code>战斗事件处理的速度</code>和<code>到客户端的网络延迟</code>，大多这样的游戏是把战斗从GameService单独拆分出来，或许还会把Matchmaking<code>（匹配）</code>服务单独拆分出来</li>
</ul>
<h4 id="也许你的游戏也有遇到过"><a href="#也许你的游戏也有遇到过" class="headerlink" title="也许你的游戏也有遇到过"></a>也许你的游戏也有遇到过</h4><ul>
<li>游戏<code>开服</code>的时候，运营厂商疯狂的开区，甚至你想和朋友在一起玩的时候还需要排队进入</li>
<li>游戏运营到<code>中期</code>，不用排队进服了，但是好友列表、公会成员列表里面的头像灰态的越来越多</li>
<li>游戏运营到<code>后期</code>，运营商开始公告合服相关的信息，2+ 个区合并到一起，期望回到游戏前中期的盛世，也节省部分运营成本</li>
</ul>
<h4 id="倾向的需求"><a href="#倾向的需求" class="headerlink" title="倾向的需求"></a>倾向的需求</h4><ul>
<li>在游戏里的任何人都可以在一起玩（开房间的玩法）</li>
<li>不再有或者减轻服务端崩溃（重启）对玩家造成的影响</li>
<li>服务端还是需要更新的，但是这种更新维护对玩家尽量是透明的</li>
<li>没有合服的动作，或者合服对玩家是透明的</li>
</ul>
<p><u><em><strong><code>这些都指向了 大区概念（分布式）的游戏服务器架构</code></strong></em></u></p>
<h4 id="大区概念的数据"><a href="#大区概念的数据" class="headerlink" title="大区概念的数据"></a>大区概念的数据</h4><ul>
<li><strong>数据集中</strong>：数据集中存放，数据后挂<code>slaver</code>节点备份数据，当<code>master</code>数据服<code>宕机</code>，使用<code>slaver</code>的数据<ul>
<li><code>master</code> 和 <code>slaver</code> 数据同步是一个异步的过程，如果使用数据集群的处理方式<br>  <code>（1 * master + N * slaver，每次更新必须保证 1 * master + M * slaver 更新成功返回成功（M &lt; N））</code>，<br>  master 宕机后只是有<code>更大可能</code>选择到了一个数据<code>最新</code>的 slaver 节点，这是<code>可以被接受的么</code>？ <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86">CAP 布鲁尔定理</a></li>
<li>假如是一个全球大区<code>（全球通服）</code>的游戏，<code>数据节点部署</code>到那个位置才是合适的？<br>  （相对中心位置并且有不错网络环境支持的<code>新加坡</code>还是<code>重点运营的大洲</code>？）</li>
<li>在倾向分布式的系统架构里，<code>单点服务</code>的存在一定是最容易被拿出来说道的话题</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>数据分区</strong>：战斗只关心拿到正确的数据，不在意数据从哪里来的<ul>
<li>只有一个数据节点不仅会加大资源竞争，而且一但这个数据节点崩溃或者停机，所有玩家都不能玩了，数据分区减少了资源压力，如果有某几个数据节点出问题，也只影响部分玩家</li>
<li>玩家战斗需要的数据量理论上是小于完整数据量的，如果创建数据时选区规则是就近数据区路由的方式，也可以保证在大部分时候，玩家是从较近的数据节点，经过较少的路由，较快的拿到了角色的全量数据</li>
<li>当然，如果玩家在亚洲建的账号（数据区在亚洲），但是后来玩游戏是在欧洲，他需要经过跨州的网络拿到自己的数据（一般数据区只有数据存储的逻辑，这种情况可以迁移数据到欧洲的数据区）</li>
<li>如果常规做法是匹配到战斗是客户端从服务端拿到加密的战斗相关的角色数据包，直接发送到战斗服务器，战斗服务器解出数据并校验的方式（没有战斗服务器和数据区的直接交互），也存在另外的问题：在遇到跨数据区交互的内容，比如排行榜、好友、公会的功能，即使这些功能里只有玩家角色少量的信息，也会存在跨区数据查找的过程，这个过程是不可靠和难控的</li>
<li>这种数据交互一些的做法参考：玩家ID自带可解出数据分区的信息<code>（或者数据分区和ID绑定（避免数据区迁移需要变更ID的情况））</code>，好友服务器向数据区服务请求数据内容<code>（主动要）</code>，一定时间内没有返回<code>（超时时间）</code>再<code>要</code>，直到 <code>要</code> 到数据。</li>
<li>这样做法的问题显而易见，每次查看好友列表都需要向N组数据服务器请求角色数据。所以一般好友服务器会缓存好友列表界面需要的数据，比如角色名（name）、角色等级（level），这些数据发生变更的时候，数据服务器主动推送变更通知到好友服务器，好友服务器更新自己的缓存。</li>
<li>作为推送的消息，数据服务器是<code>不能确定</code>推送内容<code>一定</code>被好友服务器<code>接收并处理</code>了，<code>特别是全球服跨物理大洲的推送</code></li>
<li>一般情况，<code>好友</code>里数据的<code>更新延迟</code>是可以被接受的，我们这里也假设<code>好友列表刷新的数据</code>可以<code>接受</code>一定程度的<code>延迟和不正确</code></li>
<li>这种情况下我的建议是：数据服应尽量保证数据推送到了好友服务器（至少在出现网络问题的时候有重复推送的机制）；对于<code>重传N次</code>后依然没有到达好友服务器或者好友服务器没有正确处理掉的数据，用<code>版本号确认</code>的方式做<code>补偿更新</code></li>
<li><code>补偿更新</code>具体操作是：好友的详细信息里有一个<code>Version</code>标记（这个标记由获得好友详细信息的数据一起带过来，如果只是用作后面建议的<code>数据同步</code>方式，建议这个Version<code>（Friend.Version）</code> &#x3D;&#x3D; 数据服务器用户数据的Version<code>（User.Version）</code>），假设<code>Version</code>是<code>自增</code>的，理论上 <code>Friend.Version &lt;= User.Version</code>；客户端的一些行为：比如打开好友详情面板<code>（展示单个好友更多信息）</code>时，带着Friend.Version 到 数据服务器请求 单个用户详情信息，<code>Friend.Version != User.Version</code> 的时候，数据服务器检查到<code>Friend.Version != User.Version</code>，主动<code>补偿推送</code>最新的数据到好友服务器。<code>（当然这种补偿的做法可以是双向的，某些时候好友服务器发现自己数据错误的时候，也可以主动向数据服务器要数据</code>（主动要）<code>）</code></li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>CAP wiki</strong> (<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86">https://zh.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86</a>)<ul>
<li>在理论计算机科学中，CAP定理（CAP theorem），又被称作布鲁尔定理（Brewer’s theorem），它指出对于一个分布式计算系统来说，不可能同时满足以下三点：[1][2]</li>
<li>一致性（Consistency） （等同于所有节点访问同一份最新的数据副本）</li>
<li>可用性（Availability）（每次请求都能获取到非错的响应——但是不保证获取的数据为最新数据）</li>
<li>分区容错性（Partition tolerance）（以实际效果而言，分区相当于对通信的时限要求。系统如果不能在时限内达成数据一致性，就意味着发生了分区的情况，必须就当前操作在C和A之间做出选择[3]。）</li>
<li>根据定理，分布式系统只能满足三项中的两项而不可能满足全部三项[4]。理解CAP理论的最简单方式是想象两个节点分处分区两侧。允许至少一个节点更新状态会导致数据不一致，即丧失了C性质。如果为了保证数据一致性，将分区一侧的节点设置为不可用，那么又丧失了A性质。除非两个节点可以互相通信，才能既保证C又保证A，这又会导致丧失P性质。</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>简易的消息流程</strong><br><img src="/images/Game/distributed-service.png"></li>
<li>其中 <code>Operator Change Avatar</code> 标识一次 <code>Package for battle</code> 内部数据修改应重传一次 <code>Package for battle</code> encode 数据</li>
<li>加密方式有很多种，简单的如图示，数据服务器持公钥编码，战斗服务器持私钥解码</li>
</ul>
<h4 id="大区概念的网络"><a href="#大区概念的网络" class="headerlink" title="大区概念的网络"></a>大区概念的网络</h4><ul>
<li><strong>跨大洲的网络通讯</strong>：物理距离在我的理解里是无法避免的<ul>
<li>一条消息从亚洲到欧洲，平均需要200ms，这只是平均值（<a target="_blank" rel="noopener" href="https://wondernetwork.com/pings/%EF%BC%89%EF%BC%8C%E5%9C%A8%E6%9E%81%E7%AB%AF%E6%83%85%E5%86%B5%E8%BF%99%E4%B8%AA%E5%80%BC%E4%BC%9A%E5%BE%88%E5%A4%A7%EF%BC%8C%E5%A4%A7%E5%88%B0%E7%8E%A9%E5%AE%B6%E8%A7%89%E5%BE%97%E6%B8%B8%E6%88%8F%E5%BE%88%E5%8D%A1">https://wondernetwork.com/pings/），在极端情况这个值会很大，大到玩家觉得游戏很卡</a></li>
<li>传说一些有钱的游戏购买了运营商的专线网络做加速，但是那个成本实在太高了</li>
<li>考虑如何减轻网络延迟的影响，或者想办法把玩家尽量放到离他很近的游戏服务器（需要基于游戏玩法本身考虑）</li>
<li>确保在跨区交互上也是符合CP（参考CAP）</li>
<li>下面的一些描述基于游戏是一个开房间的方式，战斗服务器需要在战斗开始拿且仅拿一次数据，结算返回到逻辑服务器（离数据近的服务器）做数据更新</li>
<li>战斗开始，战斗服务器拿到的数据是否可以相信客户端发送到服务器的数据（客户端从数据服务器拿到战斗需要的加密数据包，并在战斗开始的时候发送到战斗服务器，战斗服务器解密并验证数据合法性），这样做可以避免跨大洲的数据交互</li>
<li>战斗结算，以类似战斗开始的方式由客户端转发结算数据到逻辑服务器</li>
<li>理论上，上面描述的方式是可行的</li>
<li>如果战斗服务器的算力很强大，延迟只考虑网络的情况，给玩家选择战斗服务器的时候需要就近选择（ping值较优的那台）</li>
<li>玩家登录后获取所有（尽可能多的）战斗服务器的列表，并做ICMP的网络探测并上报数据给到匹配服务器（匹配战斗服务器用的一组服务器Matchmaking）</li>
<li>匹配服务器基于一定的规则，尽量把玩家分配到网络较优的战斗服务器上</li>
</ul>
</li>
</ul>
<h4 id="帧同步的数据校验"><a href="#帧同步的数据校验" class="headerlink" title="帧同步的数据校验"></a>帧同步的数据校验</h4><ul>
<li>帧同步的游戏，这里一般是在战中有玩家操作的游戏（如果只是战前策略的游戏，用服务器比客户端帧数快的方式先跑完战斗结果再同步给客户端播放更合适）</li>
<li>服务端在游戏里更多是做消息转发(广播)的内容，伤害等都在客户端做，如何避免客户端作弊呢？</li>
<li>分两种最常见的帧同步游戏讨论</li>
<li>#1. 1V1的<ul>
<li>假设客户端是A、B，A计算自己的战场数据伤害等，也模拟计算B的战场数据（不然A看到B的更新会比B自己看到的慢至少1帧）</li>
<li>客户端需要同步的消息分两种：<code>玩家操作类</code>的和<code>当前战场快照</code></li>
<li>A把自己的战场快照同步给B，B根据自己的模拟数据需要做一次战场同步</li>
<li>如果让B在这个过程做一个快照间的差值计算<br>  <img src="/images/Game/lockstep-01.png"></li>
<li>这里存在一个所有权的问题：<ul>
<li>如果把A作为完全的控制方，那相当于把A的机器当作传统CS架构的S端，一切以A为准，B的一些操作内容会先发到A执行具体结果，再回传给B做结果播放；这样子逻辑看起来很清楚，结构也简单，但是做为B会感受到延迟带来的不好的体验（操作手感和表现延迟）</li>
<li>如果AB各控制一部分内容，比如主动操作的执行结果，而其他比如场景内的内容由A控制；那AB在客户端感受上都可以得到一个较好的手感和表现，但是控制权的问题也稍复杂点</li>
</ul>
</li>
</ul>
</li>
<li>#2. 断线重连的问题</li>
</ul>
<p>（待续….）</p>
<p><a target="_blank" rel="noopener" href="https://gist.github.com/jboner/2841832">https://gist.github.com/jboner/2841832</a><br><a target="_blank" rel="noopener" href="https://colin-scott.github.io/personal_website/research/interactive_latency.html">https://colin-scott.github.io/personal_website/research/interactive_latency.html</a></p>

    </div>
    
    
    
    <div>
      
      <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">------ 本文结束 ------</div>
        <div style="text-align:center;color: #ccc;font-size:14px;">------ 版权声明：转载请注明出处 ------</div>
    
</div>
      
    </div>

    
    
    
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://github.com/kinly">
            <span class="icon">
              <i class="fab fa-github"></i>
            </span>

            <span class="label">GitHub</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="mailto:klysisle@outlook.com">
            <span class="icon">
              <i class="fa fa-envelope"></i>
            </span>

            <span class="label">E-Mail</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/kinly-wechat-channel.jpg">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat Image</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" rel="tag"># 游戏开发</a>
          </div>

        
  <div class="post-widgets">
    <div class="wp_rating">
      <div id="wpac-rating"></div>
    </div>
  </div>


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/archives/136816a5.html" rel="prev" title="cmake 常用备忘">
      <i class="fa fa-chevron-left"></i> cmake 常用备忘
    </a></div>
      <div class="post-nav-item">
    <a href="/archives/d610ad0a.html" rel="next" title="分享：音乐">
      分享：音乐 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E6%B8%B8%E6%88%8F"><span class="nav-number">2.</span> <span class="nav-text">常见的游戏</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84MMO%E6%B8%B8%E6%88%8F%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%9E%B6%E6%9E%84"><span class="nav-number">2.1.</span> <span class="nav-text">常见的MMO游戏服务端架构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B9%9F%E8%AE%B8%E4%BD%A0%E7%9A%84%E6%B8%B8%E6%88%8F%E4%B9%9F%E6%9C%89%E9%81%87%E5%88%B0%E8%BF%87"><span class="nav-number">2.2.</span> <span class="nav-text">也许你的游戏也有遇到过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%80%BE%E5%90%91%E7%9A%84%E9%9C%80%E6%B1%82"><span class="nav-number">2.3.</span> <span class="nav-text">倾向的需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%A7%E5%8C%BA%E6%A6%82%E5%BF%B5%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">2.4.</span> <span class="nav-text">大区概念的数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%A7%E5%8C%BA%E6%A6%82%E5%BF%B5%E7%9A%84%E7%BD%91%E7%BB%9C"><span class="nav-number">2.5.</span> <span class="nav-text">大区概念的网络</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%A7%E5%90%8C%E6%AD%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E6%A0%A1%E9%AA%8C"><span class="nav-number">2.6.</span> <span class="nav-text">帧同步的数据校验</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Kinly"
      src="/uploads/kinly-avatar.png">
  <p class="site-author-name" itemprop="name">Kinly</p>
  <div class="site-description" itemprop="description">Klysisle's 小窝</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">50</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/kinly" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kinly" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:klysisle@outlook.com" title="E-Mail → mailto:klysisle@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/kinly-wechat-channel.jpg" title="WeChat Image → &#x2F;images&#x2F;kinly-wechat-channel.jpg"><i class="fab fa-weixin fa-fw"></i>WeChat Image</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      friendly
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.ai233.top/" title="https:&#x2F;&#x2F;www.ai233.top&#x2F;" rel="noopener" target="_blank">33's blog(设计师、AI)</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://gqw.github.io/" title="https:&#x2F;&#x2F;gqw.github.io&#x2F;" rel="noopener" target="_blank">顾起威's blog(后端)</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Kinly</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>



  <script>
  if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id    : ,
      el    : 'wpac-rating',
      color : 'fc6423'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }
  </script>












  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '6741134bc57bd79787a9',
      clientSecret: 'ce6491d7fecebe5bf246e104cbae0f3412cc9c92',
      repo        : 'kinly.github.io',
      owner       : 'kinly',
      admin       : ['kinly'],
      id          : 'c397b18c8655462a8553fc00f9aa41f9',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
